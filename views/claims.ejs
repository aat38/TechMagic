<%- include("partials/header") %>

<% if (locals.claims) { %> 
<h1>
  Claims
</h1>

<!-- <form id="add" onSubmit="add();">  
<input value="" id="word" name="word" placeholder="word to add" type="text" >
<input value="" id="def" name="def" placeholder="definition" type="text" >
<input type="submit"></form>
<p>
  To see your update, view dictionary by your word's first letter and scroll to the bottom of the page
</p>
<form id="return">
<button formaction="/" method"GET" type="submit">Return</button>
</form>
</form> -->

<table class="table table-hover">
  <thead>
    <tr>
      <th></th>
      <th>Customer</th>
      <th>Product</th>
      <th>Issue</th>
      <th>Description</th>
      <th>Technician</th>
      <th>Open Date</th>
      <th>Status</th>
      <th>Resolution</th>
    </tr>
  </thead>
  <% claims.forEach(result=>{ %>
  <% var dateOpened = new Date(result.dateopened) %>
  <% var dateOpened = dateOpened.getDate() + "/" +  (dateOpened.getMonth()+1) + "/" + dateOpened.getFullYear() %>

  <tbody>
    <tr>
      <td>
        <div class="dropdown">
          <button class="dropdown-toggle" type="button" data-toggle="dropdown">Edit
          <span class="caret"></span></button>
          <ul class="dropdown-menu">
            <% if (result.resolution==='unresolved') { %>
            <li><a href="#">Resolve</a></li>
            <%}%>
            <% if (result.status==='Closed') { %>
            <li><a href="#">Re-open</a></li>
            <%}%>
            <% if (result.resolution!='unresolved' & result.status==='Open' ) {%>
            <li><a href="#">Close</a></li>
            <%}%>
            <li><a href="#">Edit Claim</a></li> 
          </ul>
        </div>
      </td>
      <td><%=result.customer%></td>
      <td><%=result.product%></td>
      <td><%=result.issue%></td>
      <td><%=result.description%></td>
      <td><%=result.employee%></td>
      <td><%= dateOpened %></td>
      <td><%=result.status%></td>
      <td><%=result.resolution%></td> 
    </tr> 
  </tbody>
  <%})%>

</table>
</p>
<%}else{%>
<h1>
 No Open Claims Found
</h1>
<%}%>

<script type=text/javascript>  
// function openDropDown(e) {
//   var x = e.clientX  //x position within the element.
//   var y = e.clientY   //y position within the element.
// document.getElementsByClassName("dropdown")[0].style.top=x+"px"
// document.getElementsByClassName("dropdown")[0].style.left=y+"px";
// document.getElementsByClassName("dropdown")[0].style.display="block";
// }
// /* When the user clicks on the button, 
// toggle between hiding and showing the dropdown content */
// function myFunction() {
//   document.getElementById("dropdownContent").style.display="block"
// }

// // Close the dropdown if the user clicks outside of it
// window.onclick = function(event) {
//   if (!event.target.matches('.button')) {
//     document.getElementById("dropdownContent").style.display="none"
//   }
// }
</script>

<%- include("partials/footer") %>

